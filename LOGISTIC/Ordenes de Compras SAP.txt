	SELECT  VBAK.ERDAT AS FECHA_PEDIDO,
			VBAK.VBELN AS COD_PEDIDO,
			VBAK.AUART AS COD_DOC,
			VBAK.KUNNR AS COD_CLIENTE,
			KNA1.NAME1 AS NOMBRE_CLIENTE,
			KNA1.MCOD3 AS CIUDAD_CLIENTE,
		    T005U.BEZEI AS PROVINCIA_CLIENTE,
		    MARA.MATKL AS COD_GRUPO_MATERIALES,
		    VBAP.WERKS AS COD_OFC,
		    VBAP.LGORT AS COD_ALMACEN,
			T023T.WGBEZ AS GRUPO_MATERIALES,
			MARA.BISMT AS COD_MATERIAL_R3,
			VBAP.MATNR AS COD_MATERIAL_HANA,
			MAKT.MAKTX AS NOMBRE_MATERIAL,
			MARA.LABOR AS COD_MARCA,
			T024X.LBTXT AS MARCA,
			
			SUM(CASE
	    		WHEN VBAK.AUART = 'ZDV1' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZKR1' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZDP1' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZNC1' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZNR1' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZAS1' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZAS2' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZB01' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZB03' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'ZDT1' THEN (VBAP.KZWI1 * -1)
	    		WHEN VBAK.AUART = 'S1' THEN (VBAP.KZWI1 * -1)
	    		ELSE VBAP.KZWI1 END) AS VALOR_ANTES_DESCUENTO,
	    		
	    		
	   
				
	    		SUM(CASE
	    		WHEN VBAK.AUART = 'ZDV1' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZKR1' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZDP1' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZNC1' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZNR1' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZAS1' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZAS2' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZB01' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZB03' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'ZDT1' THEN (VBAP.NETWR * -1)
	    		WHEN VBAK.AUART = 'S1' THEN (VBAP.NETWR * -1)
	    		ELSE VBAP.NETWR END) AS VALOR_ANTES_IVA
	
	
	FROM SAPABAP1.VBAK
	
	INNER JOIN SAPABAP1.VBAP ON VBAK.VBELN = VBAP.VBELN
	INNER JOIN SAPABAP1.KNA1 ON VBAK.KUNNR = KNA1.KUNNR
	INNER JOIN SAPABAP1.MARA ON VBAP.MATNR = MARA.MATNR --- MAESTRO DE MATERIALES ---
	INNER JOIN SAPABAP1.ADRC ON ADRC.ADDRNUMBER = KNA1.ADRNR --- DIRECCIONES GEOGRAFICAS ---
	INNER JOIN SAPABAP1.T005U ON T005U.BLAND = ADRC.REGION --- PROVINCIA SECTORIZADAS ----
	   					AND T005U.LAND1 = ADRC.COUNTRY
	
	 LEFT JOIN SAPABAP1.T023T ON VBAP.MATKL = T023T.MATKL --- GRUPO DE MATERIALES ----
	 LEFT JOIN SAPABAP1.T024X ON T024X.LABOR = MARA.LABOR ------- MARCAS --------
	   					AND T024X.SPRAS = 'S'
	   					AND T024X.MANDT = MARA.MANDT
	 INNER JOIN SAPABAP1.TSPAT ON VBAP.SPART = TSPAT.SPART  --- GRUPO ARTICULO ----
	  				   AND TSPAT.MANDT = '300' 
					   AND TSPAT.SPRAS = 'S'
					   
	  INNER JOIN SAPABAP1.MAKT ON MARA.MATNR = MAKT.MATNR   ---- NOMBRE MATERIALES ----
	
	
	GROUP BY VBAK.ERDAT ,
			VBAK.VBELN ,
			VBAK.KUNNR,
			KNA1.NAME1 ,
			KNA1.MCOD3 ,
		    T005U.BEZEI ,
		    MARA.MATKL ,
			T023T.WGBEZ ,
			MARA.BISMT ,
			VBAP.MATNR ,
			MAKT.MAKTX ,
			MARA.LABOR ,
			T024X.LBTXT,
			VBAK.AUART,
			VBAP.WERKS ,
		    VBAP.LGORT
			
		
